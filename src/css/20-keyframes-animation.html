<!doctype html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>keyframes animation</title>
    <link rel="shortcut icon" href="/public/favicon/likelion.ico" type="image/x-icon" />
    <link rel="icon" href="/public/favicon/likelion.svg" type="image/svg" />
    <link rel="preload" as="font" href="/public/font/suit/SUIT-Variable.woff2" />
    <link rel="stylesheet" href="/public/font/suit/SUIT-Variable.css" />
    <link rel="stylesheet" href="/src/common/index.css" />
    <link rel="stylesheet" href="/src/css/styles/20-keyframes-animation.css" />
    <script type="module">
      // 모든 토글 버튼과 초기화 버튼 선택
      const toggleButtons = document.querySelectorAll('.toggle-animation');
      const resetButtons = document.querySelectorAll('.reset-animation');

      // 토글 버튼에 이벤트 리스너 추가
      toggleButtons.forEach((button) => {
        button.addEventListener('click', function () {
          // 버튼이 속한 case 요소 찾기
          const caseElement = button.closest('.case');

          // case 요소 내의 애니메이션 타겟 찾기
          const targetAnimation = caseElement.querySelector('.target-animation');

          // 현재 애니메이션 상태 확인
          const currentState = getComputedStyle(targetAnimation).animationPlayState;

          if (currentState === 'running') {
            // 애니메이션이 실행 중이면 일시정지
            targetAnimation.style.animationPlayState = 'paused';

            // 가상 요소 애니메이션도 일시정지하기 위한 스타일 추가
            const styleElement = getOrCreateStyleElement(caseElement);
            styleElement.textContent = `
                  .${caseElement.className.split(' ').join('.')} .target-animation::before,
                  .${caseElement.className.split(' ').join('.')} .target-animation::after {
                      animation-play-state: paused !important;
                  }
              `;

            button.textContent = '재생';
            button.classList.remove('paused');
          } else {
            // 애니메이션이 일시정지 상태면 실행
            targetAnimation.style.animationPlayState = 'running';

            // 가상 요소 애니메이션도 실행하기 위한 스타일 추가
            const styleElement = getOrCreateStyleElement(caseElement);
            styleElement.textContent = `
                  .${caseElement.className.split(' ').join('.')} .target-animation::before,
                  .${caseElement.className.split(' ').join('.')} .target-animation::after {
                      animation-play-state: running !important;
                  }
              `;

            button.textContent = '일시정지';
            button.classList.add('paused');
          }
        });
      });

      // 초기화 버튼에 이벤트 리스너 추가
      resetButtons.forEach((button) => {
        button.addEventListener('click', function () {
          // 버튼이 속한 case 요소 찾기
          const caseElement = button.closest('.case');

          // case 요소 내의 애니메이션 타겟과 토글 버튼 찾기
          const targetAnimation = caseElement.querySelector('.target-animation');
          const toggleButton = caseElement.querySelector('.toggle-animation');

          // 애니메이션 재설정을 위해 일시적으로 제거
          const originalAnimation = targetAnimation.style.animation;
          targetAnimation.style.animation = 'none';

          // 가상 요소 애니메이션도 재설정하기 위한 스타일 추가
          const styleElement = getOrCreateStyleElement(caseElement);
          styleElement.textContent = `
              .${caseElement.className.split(' ').join('.')} .target-animation::before,
              .${caseElement.className.split(' ').join('.')} .target-animation::after {
                  animation: none !important;
              }
          `;

          // 강제로 리플로우 발생시켜 애니메이션 재설정
          void targetAnimation.offsetWidth;

          // 원래 애니메이션 스타일 복원하고 일시정지 상태로 설정
          targetAnimation.style.animation = '';
          targetAnimation.style.animationPlayState = 'paused';

          // 가상 요소 애니메이션도 원래대로 복원하고 일시정지 상태로 설정
          setTimeout(() => {
            styleElement.textContent = `
                  .${caseElement.className.split(' ').join('.')} .target-animation::before,
                  .${caseElement.className.split(' ').join('.')} .target-animation::after {
                      animation-play-state: paused !important;
                  }
              `;
          }, 10); // 약간의 지연을 주어 애니메이션이 적용될 시간 확보

          // 토글 버튼 상태 초기화
          toggleButton.textContent = '재생';
          toggleButton.classList.remove('paused');
        });
      });

      // 케이스별 스타일 요소를 가져오거나 생성하는 함수
      function getOrCreateStyleElement(caseElement) {
        // 고유 ID 생성
        const styleId = `style-${caseElement.className.replace(/\s+/g, '-')}`;

        // 이미 존재하는지 확인
        let styleElement = document.getElementById(styleId);

        // 없으면 새로 생성
        if (!styleElement) {
          styleElement = document.createElement('style');
          styleElement.id = styleId;
          document.head.appendChild(styleElement);
        }

        return styleElement;
      }
    </script>
  </head>
  <body>
    <a href="/index.html">Index로 이동</a>
    <h1>keyframes animation</h1>
    <div class="container">
      <div class="case rotate">
        <strong>CSS 변수를 활용한 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case wobble">
        <strong>Wobble 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case pulse">
        <strong>Pulse 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case flip">
        <strong>Flip 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case spin">
        <strong>Spin 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case shake">
        <strong>Shake 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case bounce">
        <strong>Bounce 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <hr />
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case shrink">
        <strong>Shrink 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
      <div class="case fade">
        <strong>Fade 애니메이션</strong>
        <div class="controls">
          <button type="button" class="reset-animation button">초기화</button>
          <button type="button" class="toggle-animation button">재생</button>
        </div>
        <div class="target-animation">멋쟁이</div>
      </div>
      <hr />
    </div>
  </body>
</html>